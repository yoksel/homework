function addVideoToCanvasWebGL(a){function b(){if(f.clear(f.COLOR_BUFFER_BIT),f.activeTexture(f.TEXTURE0),f.bindTexture(f.TEXTURE_2D,m),d)try{f.texImage2D(f.TEXTURE_2D,0,f.RGB,f.RGB,f.UNSIGNED_BYTE,c)}catch(a){n++,10>n?console.log(a):10==n&&console.log("...")}f.bindBuffer(f.ARRAY_BUFFER,k),f.vertexAttribPointer(j,2,f.FLOAT,!1,0,0),f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,l),f.drawElements(f.TRIANGLES,6,f.UNSIGNED_SHORT,0),window.requestAnimationFrame(b)}var c=document.querySelector(".video"),d=!1;c.autoplay=!0,c.loop=!0,c.oncanplay=function(){d=!0},c.onerror=function(){var a="unknown error";switch(c.error.code){case 1:a="video loading aborted";break;case 2:a="network loading error";break;case 3:a="video decoding failed / corrupted data or unsupported codec";break;case 4:a="video not supported";}console.log("Error: "+a+" (errorcode="+c.error.code+")")},c.srcObject=a,c.play();var e=document.getElementById("video-canvas"),f=e.getContext("webgl");f||console.log("No WebGL support"),f.enable(f.BLEND),f.blendFunc(f.SRC_ALPHA,f.ONE_MINUS_SRC_ALPHA);var g=f.createShader(f.VERTEX_SHADER);f.shaderSource(g,"attribute vec2 vx;varying vec2 tx;void main(){gl_Position=vec4(vx.x*2.0-1.0,1.0-vx.y*2.0,0,1);tx=vx;}"),f.compileShader(g);var h=f.createShader(f.FRAGMENT_SHADER);f.shaderSource(h,"precision mediump float;uniform sampler2D sm;varying vec2 tx;void main(){gl_FragColor=texture2D(sm,tx);}"),f.compileShader(h);var i=f.createProgram();f.attachShader(i,g),f.attachShader(i,h),f.linkProgram(i),f.useProgram(i);var j=f.getAttribLocation(i,"vx");f.enableVertexAttribArray(j),f.uniform1i(f.getUniformLocation(i,"sm"),0);var k=f.createBuffer();f.bindBuffer(f.ARRAY_BUFFER,k),f.bufferData(f.ARRAY_BUFFER,new Float32Array([0,0,1,0,1,1,0,1]),f.STATIC_DRAW);var l=f.createBuffer();f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,l),f.bufferData(f.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,0,2,3]),f.STATIC_DRAW);var m=f.createTexture();f.bindTexture(f.TEXTURE_2D,m),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.LINEAR),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.LINEAR);var n=0;b()}"use strict",function(){function a(a){function b(a,c){a.paused||a.ended||(c.drawImage(a,0,0),requestAnimationFrame(function(){b(a,c)}))}var c=document.querySelector("#video-canvas"),d=c.getContext("2d",{alpha:!1});a.addEventListener("loadedmetadata",function(){c.width=a.videoWidth,c.height=a.videoHeight}),a.addEventListener("play",function(){b(a,d)},0)}function b(a){function b(a,g){if(!a.paused&&!a.ended){g.drawImage(a,0,0,f.clientWidth,f.clientHeight);var i=g.getImageData(0,0,f.width,f.height),j=i.data;if(d){var k=c(d,j);!1===k?e.classList.add(h):e.classList.remove(h)}d=j,setTimeout(function(){requestAnimationFrame(function(){b(a,g)})},500)}}var d="",e=document.querySelector(".move-detection"),f=document.querySelector(".move-detection__detector"),g=f.getContext("2d",{alpha:!1}),h="move-detection--detected";a.addEventListener("play",function(){e.classList.remove("move-detection--hidden"),b(a,g)},0)}function c(a,b){for(var c=!0,d=0;d<a.length;d+=500)if(Math.abs(a[d]-b[d])>20)return!1;return c}function d(a){var b,c=new(window.AudioContext||window.webkitAudioContext),d=c.createAnalyser();d.minDecibels=-90,d.maxDecibels=-10,d.smoothingTimeConstant=.85;var e=c.createWaveShaper(),f=c.createGain(),g=c.createBiquadFilter(),h=c.createConvolver(),i=document.querySelector(".audio-visualizer"),j=document.querySelector(".audio-visualizer__canvas"),k=j.getContext("2d");navigator.mediaDevices.getUserMedia?(b=c.createMediaStreamSource(a),b.connect(d),d.connect(e),e.connect(g),g.connect(h),h.connect(f),f.connect(c.destination),i.classList.remove("audio-visualizer--hidden"),function(){var a=j.width,b=j.height;d.fftSize=256;var c=d.frequencyBinCount,e=new Uint8Array(c);k.clearRect(0,0,a,b);var f=function(){drawVisual=requestAnimationFrame(f),d.getByteFrequencyData(e),k.fillStyle="hsl(0, 0, 0)",k.fillRect(0,0,a,b);for(var g,h=2.5*(a/c),j=0,l=0;l<c;l++)g=e[l],k.fillStyle="hsl(0, 0%,"+g+"%)",k.fillRect(j,b-g/2,h,g/2),j+=h+1};f()}()):console.log("getUserMedia not supported on your browser")}function e(a){var b=4,c=45,d=120,e=d,f=document.querySelector(".data"),h=document.createElement("ul");h.classList.add("data__list"),a.addEventListener("play",function(){f.classList.remove("data--hidden")},0);for(var j,l=0;l<b;l++){j=document.createElement("li"),j.classList.add("data__item"),j.innerHTML="",h.appendChild(j);var m=0,p=3,q=[g(8*Math.random())+5,g(4*Math.random())+6],r=0,s=q[r],t=g(Math.random()*c/2)+c/2,u=q[0]+q[1]+2*p;t-p<=u&&(t=u-p);for(var i=0;i<t;i++){if(m>s&&m<=s+p)j.innerHTML+=i+"<br/>",m==s+p&&(r++,s=q[r],m=0);else{for(var k=[e,(50*e).toString(16)],n=g(2*Math.random())+1,o=0;o<n;o++)k.push((e-40+o).toString(16));j.innerHTML+=content=k.join("\t")+"<br/>"}m++,e++}}f.appendChild(h)}function f(){function a(){if("up"===m)i<j?(i+=l,b(),!h&&(e.classList.add(f),h=!0)):(m="down",b(),h&&(e.classList.remove(f),h=!1));else if(0<i)i-=l,b();else{var d=g(3*Math.random())+5;c.setAttribute("scale",0),setTimeout(function(){a(),m="up"},1e3*d)}}function b(){var b=i;k=i/2.5,i%2&&(b=-b),c.setAttribute("scale",b),d.setAttribute("x",-k),d.setAttribute("y",-k),requestAnimationFrame(a)}var c=document.getElementById("feMap"),d=document.getElementById("feOffset"),e=document.querySelector(".content"),f="content--has-filter",h=!1,i=0,j=100,k=0,l=5,m="up";a()}var g=Math.round;(function(){navigator.mediaDevices.getUserMedia({audio:!0,video:{width:{min:300,ideal:800},height:{min:200,ideal:600}}}).then(function(c){var g=document.querySelector(".video"),h=document.querySelector(".content");g.srcObject=c;g.addEventListener("loadedmetadata",function(){g.play(),h.classList.add("content--video-playing")}),d(c),a(g,c),b(g,c),e(g),f()}).catch(function(a){console.log("Error: ",a.name+": "+a.message)})})()}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL2FkZFZpZGVvVG9DYW52YXNXZWJHTC5qcyIsImpzL2NvbW1vbi5qcyJdLCJuYW1lcyI6WyJhZGRWaWRlb1RvQ2FudmFzV2ViR0wiLCJjbGVhciIsIkNPTE9SX0JVRkZFUl9CSVQiLCJhY3RpdmVUZXh0dXJlIiwiVEVYVFVSRTAiLCJiaW5kVGV4dHVyZSIsIlRFWFRVUkVfMkQiLCJ0ZXhJbWFnZTJEIiwiUkdCIiwiVU5TSUdORURfQllURSIsImNvbnNvbGUiLCJsb2ciLCJiaW5kQnVmZmVyIiwiQVJSQVlfQlVGRkVSIiwidmVydGV4QXR0cmliUG9pbnRlciIsIkZMT0FUIiwiRUxFTUVOVF9BUlJBWV9CVUZGRVIiLCJkcmF3RWxlbWVudHMiLCJUUklBTkdMRVMiLCJVTlNJR05FRF9TSE9SVCIsIndpbmRvdyIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImF1dG9wbGF5IiwibG9vcCIsIm9uY2FucGxheSIsIm9uZXJyb3IiLCJlcnJvciIsImNvZGUiLCJzcmNPYmplY3QiLCJwbGF5IiwiZ2V0RWxlbWVudEJ5SWQiLCJnZXRDb250ZXh0IiwiZW5hYmxlIiwiQkxFTkQiLCJibGVuZEZ1bmMiLCJTUkNfQUxQSEEiLCJPTkVfTUlOVVNfU1JDX0FMUEhBIiwiY3JlYXRlU2hhZGVyIiwiVkVSVEVYX1NIQURFUiIsInNoYWRlclNvdXJjZSIsImNvbXBpbGVTaGFkZXIiLCJGUkFHTUVOVF9TSEFERVIiLCJjcmVhdGVQcm9ncmFtIiwiYXR0YWNoU2hhZGVyIiwibGlua1Byb2dyYW0iLCJ1c2VQcm9ncmFtIiwiZ2V0QXR0cmliTG9jYXRpb24iLCJlbmFibGVWZXJ0ZXhBdHRyaWJBcnJheSIsInVuaWZvcm0xaSIsImdldFVuaWZvcm1Mb2NhdGlvbiIsImNyZWF0ZUJ1ZmZlciIsImJ1ZmZlckRhdGEiLCJGbG9hdDMyQXJyYXkiLCJTVEFUSUNfRFJBVyIsIlVpbnQxNkFycmF5IiwiY3JlYXRlVGV4dHVyZSIsInRleFBhcmFtZXRlcmkiLCJURVhUVVJFX1dSQVBfVCIsIkNMQU1QX1RPX0VER0UiLCJURVhUVVJFX1dSQVBfUyIsIlRFWFRVUkVfTUFHX0ZJTFRFUiIsIkxJTkVBUiIsIlRFWFRVUkVfTUlOX0ZJTFRFUiIsInBhdXNlZCIsImVuZGVkIiwiZHJhd0ltYWdlIiwiYWxwaGEiLCJhZGRFdmVudExpc3RlbmVyIiwid2lkdGgiLCJ2aWRlb1dpZHRoIiwiaGVpZ2h0IiwidmlkZW9IZWlnaHQiLCJjbGllbnRXaWR0aCIsImNsaWVudEhlaWdodCIsImdldEltYWdlRGF0YSIsImRhdGEiLCJjbGFzc0xpc3QiLCJhZGQiLCJyZW1vdmUiLCJzZXRUaW1lb3V0IiwibGVuZ3RoIiwiTWF0aCIsImFicyIsIkF1ZGlvQ29udGV4dCIsIndlYmtpdEF1ZGlvQ29udGV4dCIsImNyZWF0ZUFuYWx5c2VyIiwibWluRGVjaWJlbHMiLCJtYXhEZWNpYmVscyIsInNtb290aGluZ1RpbWVDb25zdGFudCIsImNyZWF0ZVdhdmVTaGFwZXIiLCJjcmVhdGVHYWluIiwiY3JlYXRlQmlxdWFkRmlsdGVyIiwiY3JlYXRlQ29udm9sdmVyIiwibmF2aWdhdG9yIiwibWVkaWFEZXZpY2VzIiwiZ2V0VXNlck1lZGlhIiwiY3JlYXRlTWVkaWFTdHJlYW1Tb3VyY2UiLCJjb25uZWN0IiwiZGVzdGluYXRpb24iLCJmZnRTaXplIiwiZnJlcXVlbmN5QmluQ291bnQiLCJVaW50OEFycmF5IiwiY2xlYXJSZWN0IiwiZHJhd1Zpc3VhbCIsImdldEJ5dGVGcmVxdWVuY3lEYXRhIiwiZmlsbFN0eWxlIiwiZmlsbFJlY3QiLCJjcmVhdGVFbGVtZW50IiwiaW5uZXJIVE1MIiwiYXBwZW5kQ2hpbGQiLCJyYW5kb20iLCJ0b1N0cmluZyIsInB1c2giLCJjb250ZW50Iiwiam9pbiIsInNldEF0dHJpYnV0ZSIsInJvdW5kIiwiYXVkaW8iLCJ2aWRlbyIsIm1pbiIsImlkZWFsIiwidGhlbiIsImNhdGNoIiwibmFtZSIsIm1lc3NhZ2UiXSwibWFwcGluZ3MiOiJBQUVBLFFBQUFBLHNC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RUFBQSxHQU5BLENBT0EsRUFBQSxDQVBBLENBUUEsRUFBQSxDQVJBLENBU0EsRUFBQSxJQVRBLENBV0EsR0FzREEsQ0F4VkEsTUFxT0E0RCxLQUFBbUMsS0FyT0EsQ0E0VkEsQ0ExVkEsVUFBQSxDQUdBdkIsVUFBQUMsWUFBQSxDQUFBQyxZQUFBLENBQUEsQ0FDQXNCLFFBREEsQ0FFQUMsTUFBQSxDQUNBbEQsTUFBQSxDQUFBbUQsSUFBQSxHQUFBLENBQUFDLE1BQUEsR0FBQSxDQURBLENBRUFsRCxPQUFBLENBQUFpRCxJQUFBLEdBQUEsQ0FBQUMsTUFBQSxHQUFBLENBRkEsQ0FGQSxDQUFBLEVBT0FDLElBUEEsQ0FPQSxXQUFBLENBQ0EsR0FBQSxHQUFBckcsU0FBQUMsYUFBQSxDQUFBLFFBQUEsQ0FBQSxDQUNBLEVBQUFELFNBQUFDLGFBQUEsQ0FBQSxVQUFBLENBREEsQ0FHQSxFQUFBTyxTQUFBLEVBSkEsQ0FPQSxFQUFBdUMsZ0JBQUEsQ0FBQSxnQkFBQSxDQUFBLFVBQUEsQ0FDQSxFQUFBdEMsSUFBQSxFQURBLENBRUEsRUFBQStDLFNBQUEsQ0FBQUMsR0FBQSxDQUFBLHdCQUFBLENBQ0EsQ0FIQSxDQVBBLENBWUEsSUFaQSxDQWFBLE1BYkEsQ0FjQSxNQWRBLENBZ0JBLElBaEJBLENBaUJBLEdBSUEsQ0E1QkEsRUE2QkE2QyxLQTdCQSxDQTZCQSxXQUFBLENBQ0FsSCxRQUFBQyxHQUFBLENBQUEsU0FBQSxDQUFBLEVBQUFrSCxJQUFBLENBQUEsSUFBQSxDQUFBLEVBQUFDLE9BQUEsQ0FDQSxDQS9CQSxDQWdDQSxDQXVUQSxHQUVBLENBOVZBLEUiLCJmaWxlIjoiY29tbW9uLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gU291cmNlOiBodHRwczovL2tycGFuby5jb20vaW9zL2J1Z3MvaW9zOC13ZWJnbC12aWRlby9cblxuZnVuY3Rpb24gYWRkVmlkZW9Ub0NhbnZhc1dlYkdMKG1lZGlhU3RyZWFtKSB7XG4gIHZhciB2aWRlbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy52aWRlbycpO1xuICB2YXIgdmlkZW9Jc1JlYWR5ID0gZmFsc2U7XG4gIHZpZGVvLmF1dG9wbGF5ID0gdHJ1ZTtcbiAgdmlkZW8ubG9vcCA9IHRydWU7XG5cbiAgdmlkZW8ub25jYW5wbGF5ID0gZnVuY3Rpb24gKCkge1xuICAgIHZpZGVvSXNSZWFkeT10cnVlO1xuICB9O1xuXG4gIHZpZGVvLm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGVyciA9IFwidW5rbm93biBlcnJvclwiO1xuXG4gICAgc3dpdGNoKHZpZGVvLmVycm9yLmNvZGUpXG4gICAge1xuICAgICAgY2FzZSAxOiBlcnIgPSBcInZpZGVvIGxvYWRpbmcgYWJvcnRlZFwiOyBicmVhaztcbiAgICAgIGNhc2UgMjogZXJyID0gXCJuZXR3b3JrIGxvYWRpbmcgZXJyb3JcIjsgYnJlYWs7XG4gICAgICBjYXNlIDM6IGVyciA9IFwidmlkZW8gZGVjb2RpbmcgZmFpbGVkIC8gY29ycnVwdGVkIGRhdGEgb3IgdW5zdXBwb3J0ZWQgY29kZWNcIjsgYnJlYWs7XG4gICAgICBjYXNlIDQ6IGVyciA9IFwidmlkZW8gbm90IHN1cHBvcnRlZFwiOyBicmVhaztcbiAgICB9O1xuXG4gICAgY29uc29sZS5sb2coXCJFcnJvcjogXCIgKyBlcnIgKyBcIiAoZXJyb3Jjb2RlPVwiK3ZpZGVvLmVycm9yLmNvZGUrXCIpXCIpO1xuICB9O1xuXG4gIHZpZGVvLnNyY09iamVjdCA9IG1lZGlhU3RyZWFtO1xuICB2aWRlby5wbGF5KCk7XG5cbiAgdmFyIGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidmlkZW8tY2FudmFzXCIpO1xuICBjb25zdCBnbCA9IGNhbnZhcy5nZXRDb250ZXh0KCd3ZWJnbCcpO1xuXG4gIGlmICghZ2wpIHtcbiAgICBjb25zb2xlLmxvZyhcIk5vIFdlYkdMIHN1cHBvcnRcIik7XG4gIH1cblxuICAvLyBwcmVwYXJlIFdlYkdMXG4gIGdsLmVuYWJsZShnbC5CTEVORCk7XG4gIGdsLmJsZW5kRnVuYyhnbC5TUkNfQUxQSEEsIGdsLk9ORV9NSU5VU19TUkNfQUxQSEEpO1xuXG4gIHZhciB2cyA9IGdsLmNyZWF0ZVNoYWRlcihnbC5WRVJURVhfU0hBREVSKTtcbiAgZ2wuc2hhZGVyU291cmNlKHZzLCBcImF0dHJpYnV0ZSB2ZWMyIHZ4O3ZhcnlpbmcgdmVjMiB0eDt2b2lkIG1haW4oKXtnbF9Qb3NpdGlvbj12ZWM0KHZ4LngqMi4wLTEuMCwxLjAtdngueSoyLjAsMCwxKTt0eD12eDt9XCIpO1xuICBnbC5jb21waWxlU2hhZGVyKHZzKTtcblxuICB2YXIgcHMgPSBnbC5jcmVhdGVTaGFkZXIoZ2wuRlJBR01FTlRfU0hBREVSKTtcbiAgZ2wuc2hhZGVyU291cmNlKHBzLCBcInByZWNpc2lvbiBtZWRpdW1wIGZsb2F0O3VuaWZvcm0gc2FtcGxlcjJEIHNtO3ZhcnlpbmcgdmVjMiB0eDt2b2lkIG1haW4oKXtnbF9GcmFnQ29sb3I9dGV4dHVyZTJEKHNtLHR4KTt9XCIpO1xuICBnbC5jb21waWxlU2hhZGVyKHBzKTtcblxuICB2YXIgc2hhZGVyICA9IGdsLmNyZWF0ZVByb2dyYW0oKTtcbiAgZ2wuYXR0YWNoU2hhZGVyKHNoYWRlciwgdnMpO1xuICBnbC5hdHRhY2hTaGFkZXIoc2hhZGVyLCBwcyk7XG4gIGdsLmxpbmtQcm9ncmFtKHNoYWRlcik7XG4gIGdsLnVzZVByb2dyYW0oc2hhZGVyKTtcblxuICB2YXIgdnhfcHRyID0gZ2wuZ2V0QXR0cmliTG9jYXRpb24oc2hhZGVyLCBcInZ4XCIpO1xuICBnbC5lbmFibGVWZXJ0ZXhBdHRyaWJBcnJheSh2eF9wdHIpO1xuICBnbC51bmlmb3JtMWkoZ2wuZ2V0VW5pZm9ybUxvY2F0aW9uKHNoYWRlciwgXCJzbVwiKSwgMCk7XG5cbiAgdmFyIHZ4ID0gZ2wuY3JlYXRlQnVmZmVyKCk7XG4gIGdsLmJpbmRCdWZmZXIoZ2wuQVJSQVlfQlVGRkVSLCB2eCk7XG4gIGdsLmJ1ZmZlckRhdGEoZ2wuQVJSQVlfQlVGRkVSLCBuZXcgRmxvYXQzMkFycmF5KFswLDAsIDEsMCwgMSwxLCAwLDFdKSwgZ2wuU1RBVElDX0RSQVcpO1xuXG4gIHZhciBpeCA9IGdsLmNyZWF0ZUJ1ZmZlcigpO1xuICBnbC5iaW5kQnVmZmVyKGdsLkVMRU1FTlRfQVJSQVlfQlVGRkVSLCBpeCk7XG4gIGdsLmJ1ZmZlckRhdGEoZ2wuRUxFTUVOVF9BUlJBWV9CVUZGRVIsIG5ldyBVaW50MTZBcnJheShbMCwxLDIsIDAsMiwzXSksIGdsLlNUQVRJQ19EUkFXKTtcblxuICB2YXIgdGV4ID0gZ2wuY3JlYXRlVGV4dHVyZSgpO1xuICBnbC5iaW5kVGV4dHVyZShnbC5URVhUVVJFXzJELCB0ZXgpO1xuICBnbC50ZXhQYXJhbWV0ZXJpKGdsLlRFWFRVUkVfMkQsIGdsLlRFWFRVUkVfV1JBUF9ULCAgICAgZ2wuQ0xBTVBfVE9fRURHRSk7XG4gIGdsLnRleFBhcmFtZXRlcmkoZ2wuVEVYVFVSRV8yRCwgZ2wuVEVYVFVSRV9XUkFQX1MsICAgICBnbC5DTEFNUF9UT19FREdFKTtcbiAgZ2wudGV4UGFyYW1ldGVyaShnbC5URVhUVVJFXzJELCBnbC5URVhUVVJFX01BR19GSUxURVIsIGdsLkxJTkVBUik7XG4gIGdsLnRleFBhcmFtZXRlcmkoZ2wuVEVYVFVSRV8yRCwgZ2wuVEVYVFVSRV9NSU5fRklMVEVSLCBnbC5MSU5FQVIpO1xuXG4gIC8vIGxvYWQgdGhlIHZpZGVvXG5cblxuICB2YXIgZXJyY250PTA7XG5cbiAgLy8gcmVxdWVzdEFuaW1hdGlvbkZyYW1lIGxvb3BcbiAgZnVuY3Rpb24gZnJhbWVsb29wKClcbiAge1xuICAgIGdsLmNsZWFyKGdsLkNPTE9SX0JVRkZFUl9CSVQpO1xuXG4gICAgZ2wuYWN0aXZlVGV4dHVyZShnbC5URVhUVVJFMCk7XG4gICAgZ2wuYmluZFRleHR1cmUoZ2wuVEVYVFVSRV8yRCwgdGV4KTtcblxuICAgIGlmICh2aWRlb0lzUmVhZHkpXG4gICAge1xuICAgICAgdHJ5XG4gICAgICB7XG4gICAgICAgIC8vIHVwbG9hZCB0aGUgdmlkZW8gZnJhbWVcbiAgICAgICAgZ2wudGV4SW1hZ2UyRChnbC5URVhUVVJFXzJELCAwLCBnbC5SR0IsIGdsLlJHQiwgZ2wuVU5TSUdORURfQllURSwgdmlkZW8pO1xuICAgICAgfVxuICAgICAgY2F0Y2goZSlcbiAgICAgIHtcbiAgICAgICAgLy8gbG9nIG9ubHkgdGhlIGZpcnN0IGZldyBlcnJvcnNcbiAgICAgICAgZXJyY250Kys7XG4gICAgICAgIGlmIChlcnJjbnQgPCAxMClcbiAgICAgICAgICBjb25zb2xlLmxvZyhlKTtcbiAgICAgICAgZWxzZSBpZiAoZXJyY250ID09IDEwKVxuICAgICAgICAgIGNvbnNvbGUubG9nKFwiLi4uXCIpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGdsLmJpbmRCdWZmZXIoZ2wuQVJSQVlfQlVGRkVSLCB2eCk7XG4gICAgZ2wudmVydGV4QXR0cmliUG9pbnRlcih2eF9wdHIsIDIsIGdsLkZMT0FULCBmYWxzZSwgMCwgMCk7XG5cbiAgICBnbC5iaW5kQnVmZmVyKGdsLkVMRU1FTlRfQVJSQVlfQlVGRkVSLCBpeCk7XG4gICAgZ2wuZHJhd0VsZW1lbnRzKGdsLlRSSUFOR0xFUywgNiwgZ2wuVU5TSUdORURfU0hPUlQsIDApO1xuXG4gICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShmcmFtZWxvb3ApO1xuICB9XG5cbiAgZnJhbWVsb29wKCk7XG59XG4iLCIndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbiAoKSB7XG5cbiAgZnVuY3Rpb24gZ2V0U3RyZWFtKCkge1xuICAgIGxldCBjYW52YXNMaXN0ID0gW107XG5cbiAgICBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYSh7XG4gICAgICBhdWRpbzogdHJ1ZSxcbiAgICAgIHZpZGVvOiB7XG4gICAgICAgIHdpZHRoOiB7IG1pbjogMzAwLCBpZGVhbDogODAwIH0sXG4gICAgICAgIGhlaWdodDogeyBtaW46IDIwMCwgaWRlYWw6IDYwMCB9XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICAudGhlbihmdW5jdGlvbihtZWRpYVN0cmVhbSkge1xuICAgICAgICBjb25zdCB2aWRlbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy52aWRlbycpO1xuICAgICAgICBjb25zdCBjb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRlbnQnKTtcblxuICAgICAgICB2aWRlby5zcmNPYmplY3QgPSBtZWRpYVN0cmVhbTtcbiAgICAgICAgbGV0IHByZXZQaXhlbHMgPSAnJztcblxuICAgICAgICB2aWRlby5hZGRFdmVudExpc3RlbmVyKCdsb2FkZWRtZXRhZGF0YScsZnVuY3Rpb24oZSkge1xuICAgICAgICAgIHZpZGVvLnBsYXkoKTtcbiAgICAgICAgICBjb250ZW50LmNsYXNzTGlzdC5hZGQoJ2NvbnRlbnQtLXZpZGVvLXBsYXlpbmcnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgYWRkU291bmRWb2x1bWUobWVkaWFTdHJlYW0pO1xuICAgICAgICBhZGRWaWRlb1RvQ2FudmFzKHZpZGVvLCBtZWRpYVN0cmVhbSk7XG4gICAgICAgIGNoZWNrTW92ZSh2aWRlbywgbWVkaWFTdHJlYW0pO1xuXG4gICAgICAgIGFkZERhdGEodmlkZW8pO1xuICAgICAgICBhbmltYXRlRmlsdGVyKCk7XG5cbiAgICAgICAgLy8gQmFkIHBlcmZvcm1hbmNlXG4gICAgICAgIC8vIGFkZFZpZGVvVG9DYW52YXNXZWJHTChtZWRpYVN0cmVhbSk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuICAgICAgICBjb25zb2xlLmxvZygnRXJyb3I6ICcsIGVyci5uYW1lICsgXCI6IFwiICsgZXJyLm1lc3NhZ2UpO1xuICAgICAgfSk7XG4gIH1cblxuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIGZ1bmN0aW9uIGFkZFZpZGVvVG9DYW52YXModmlkZW8sIG1lZGlhU3RyZWFtKSB7XG4gICAgbGV0IHByZXZQaXhlbHMgPSAnJztcblxuICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyN2aWRlby1jYW52YXMnKTtcbiAgICBjb25zdCBjb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoJzJkJywgeyBhbHBoYTogZmFsc2UgfSk7XG5cbiAgICB2aWRlby5hZGRFdmVudExpc3RlbmVyKCdsb2FkZWRtZXRhZGF0YScsIGZ1bmN0aW9uKCkge1xuICAgICAgY2FudmFzLndpZHRoID0gdmlkZW8udmlkZW9XaWR0aDtcbiAgICAgIGNhbnZhcy5oZWlnaHQgPSB2aWRlby52aWRlb0hlaWdodDtcbiAgICB9KTtcblxuICAgIHZpZGVvLmFkZEV2ZW50TGlzdGVuZXIoJ3BsYXknLCBmdW5jdGlvbigpIHtcbiAgICAgIGRyYXcodmlkZW8sIGNvbnRleHQpO1xuICAgIH0sIDApO1xuXG4gICAgZnVuY3Rpb24gZHJhdyh2aWRlbywgY29udGV4dCkge1xuICAgICAgaWYgKCF2aWRlby5wYXVzZWQgJiYgIXZpZGVvLmVuZGVkKSB7XG4gICAgICAgIGNvbnRleHQuZHJhd0ltYWdlKHZpZGVvLCAwLCAwKTtcblxuICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgICAgICAgIGRyYXcodmlkZW8sIGNvbnRleHQpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIGZ1bmN0aW9uIGNoZWNrTW92ZSh2aWRlbywgbWVkaWFTdHJlYW0pIHtcbiAgICBsZXQgcHJldlBpeGVscyA9ICcnO1xuXG4gICAgY29uc3QgbW92ZURldGVjdGlvbkVsZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW92ZS1kZXRlY3Rpb24nKTtcbiAgICBjb25zdCBjYW52YXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW92ZS1kZXRlY3Rpb25fX2RldGVjdG9yJyk7XG4gICAgY29uc3QgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcsIHsgYWxwaGE6IGZhbHNlIH0pO1xuICAgIGNvbnN0IG1vdmVEZXRlY3RlZENsYXNzID0gJ21vdmUtZGV0ZWN0aW9uLS1kZXRlY3RlZCc7XG5cbiAgICB2aWRlby5hZGRFdmVudExpc3RlbmVyKCdwbGF5JywgKCkgPT4ge1xuICAgICAgbW92ZURldGVjdGlvbkVsZW0uY2xhc3NMaXN0LnJlbW92ZSgnbW92ZS1kZXRlY3Rpb24tLWhpZGRlbicpO1xuICAgICAgZHJhdyh2aWRlbywgY29udGV4dCk7XG4gICAgfSwgMCk7XG5cbiAgICBmdW5jdGlvbiBkcmF3KHZpZGVvLCBjb250ZXh0KSB7XG5cbiAgICAgIGlmICghdmlkZW8ucGF1c2VkICYmICF2aWRlby5lbmRlZCkge1xuICAgICAgICBjb250ZXh0LmRyYXdJbWFnZSh2aWRlbywgMCwgMCwgY2FudmFzLmNsaWVudFdpZHRoLCBjYW52YXMuY2xpZW50SGVpZ2h0KTtcblxuICAgICAgICBjb25zdCBpbWFnZURhdGEgPSBjb250ZXh0LmdldEltYWdlRGF0YSgwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpO1xuICAgICAgICBsZXQgbmV3UGl4ZWxzID0gaW1hZ2VEYXRhLmRhdGE7XG5cbiAgICAgICAgaWYgKHByZXZQaXhlbHMpIHtcbiAgICAgICAgICBjb25zdCBzbmFwSXNTYW1lID0gY2hlY2tQaXhlbHNEaWZmKHByZXZQaXhlbHMsIG5ld1BpeGVscyk7XG5cbiAgICAgICAgICBpZiAoc25hcElzU2FtZSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIG1vdmVEZXRlY3Rpb25FbGVtLmNsYXNzTGlzdC5hZGQobW92ZURldGVjdGVkQ2xhc3MpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG1vdmVEZXRlY3Rpb25FbGVtLmNsYXNzTGlzdC5yZW1vdmUobW92ZURldGVjdGVkQ2xhc3MpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHByZXZQaXhlbHMgPSBuZXdQaXhlbHM7XG5cbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHtcbiAgICAgICAgICAgIGRyYXcodmlkZW8sIGNvbnRleHQpO1xuICAgICAgICAgIH0pXG4gICAgICAgIH0sXG4gICAgICAgIDUwMCk7XG5cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIGZ1bmN0aW9uIGNoZWNrUGl4ZWxzRGlmZihwcmV2UGl4ZWxzLCBuZXdQaXhlbHMpIHtcbiAgICBsZXQgc25hcElzU2FtZSA9IHRydWU7XG4gICAgY29uc3QgdGhyZXNob2xkID0gMjA7XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByZXZQaXhlbHMubGVuZ3RoOyBpICs9IDUwMCkge1xuICAgICAgaWYgKE1hdGguYWJzKHByZXZQaXhlbHNbaV0gLSBuZXdQaXhlbHNbaV0pID4gdGhyZXNob2xkICl7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gc25hcElzU2FtZTtcbiAgfVxuXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgLy8gU291cmNlOiBodHRwczovL2dpdGh1Yi5jb20vbWRuL3ZvaWNlLWNoYW5nZS1vLW1hdGljXG4gIGZ1bmN0aW9uIGFkZFNvdW5kVm9sdW1lKG1lZGlhU3RyZWFtKSB7XG4gICAgdmFyIGF1ZGlvQ3R4ID0gbmV3ICh3aW5kb3cuQXVkaW9Db250ZXh0IHx8IHdpbmRvdy53ZWJraXRBdWRpb0NvbnRleHQpKCk7XG4gICAgdmFyIHNvdXJjZTtcblxuICAgIC8vc2V0IHVwIHRoZSBkaWZmZXJlbnQgYXVkaW8gbm9kZXMgd2Ugd2lsbCB1c2UgZm9yIHRoZSBhcHBcbiAgICB2YXIgYW5hbHlzZXIgPSBhdWRpb0N0eC5jcmVhdGVBbmFseXNlcigpO1xuICAgIGFuYWx5c2VyLm1pbkRlY2liZWxzID0gLTkwO1xuICAgIGFuYWx5c2VyLm1heERlY2liZWxzID0gLTEwO1xuICAgIGFuYWx5c2VyLnNtb290aGluZ1RpbWVDb25zdGFudCA9IDAuODU7XG5cbiAgICB2YXIgZGlzdG9ydGlvbiA9IGF1ZGlvQ3R4LmNyZWF0ZVdhdmVTaGFwZXIoKTtcbiAgICB2YXIgZ2Fpbk5vZGUgPSBhdWRpb0N0eC5jcmVhdGVHYWluKCk7XG4gICAgdmFyIGJpcXVhZEZpbHRlciA9IGF1ZGlvQ3R4LmNyZWF0ZUJpcXVhZEZpbHRlcigpO1xuICAgIHZhciBjb252b2x2ZXIgPSBhdWRpb0N0eC5jcmVhdGVDb252b2x2ZXIoKTtcblxuICAgIHZhciB2aXN1YWxpemVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmF1ZGlvLXZpc3VhbGl6ZXInKTtcbiAgICB2YXIgY2FudmFzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmF1ZGlvLXZpc3VhbGl6ZXJfX2NhbnZhcycpO1xuICAgIHZhciBjYW52YXNDdHggPSBjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xuXG4gICAgaWYgKG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhKSB7XG4gICAgICBzb3VyY2UgPSBhdWRpb0N0eC5jcmVhdGVNZWRpYVN0cmVhbVNvdXJjZShtZWRpYVN0cmVhbSk7XG4gICAgICBzb3VyY2UuY29ubmVjdChhbmFseXNlcik7XG4gICAgICBhbmFseXNlci5jb25uZWN0KGRpc3RvcnRpb24pO1xuICAgICAgZGlzdG9ydGlvbi5jb25uZWN0KGJpcXVhZEZpbHRlcik7XG4gICAgICBiaXF1YWRGaWx0ZXIuY29ubmVjdChjb252b2x2ZXIpO1xuICAgICAgY29udm9sdmVyLmNvbm5lY3QoZ2Fpbk5vZGUpO1xuICAgICAgZ2Fpbk5vZGUuY29ubmVjdChhdWRpb0N0eC5kZXN0aW5hdGlvbik7XG5cbiAgICAgIHZpc3VhbGl6ZXIuY2xhc3NMaXN0LnJlbW92ZSgnYXVkaW8tdmlzdWFsaXplci0taGlkZGVuJyk7XG4gICAgICB2aXN1YWxpemUoKTtcblxuICAgIH0gZWxzZSB7XG4gICAgICAgY29uc29sZS5sb2coJ2dldFVzZXJNZWRpYSBub3Qgc3VwcG9ydGVkIG9uIHlvdXIgYnJvd3NlcicpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHZpc3VhbGl6ZSgpIHtcbiAgICAgIGNvbnN0IHdpZHRoID0gY2FudmFzLndpZHRoO1xuICAgICAgY29uc3QgaGVpZ2h0ID0gY2FudmFzLmhlaWdodDtcblxuICAgICAgYW5hbHlzZXIuZmZ0U2l6ZSA9IDI1NjtcbiAgICAgIHZhciBidWZmZXJMZW5ndGhBbHQgPSBhbmFseXNlci5mcmVxdWVuY3lCaW5Db3VudDtcbiAgICAgIHZhciBkYXRhQXJyYXlBbHQgPSBuZXcgVWludDhBcnJheShidWZmZXJMZW5ndGhBbHQpO1xuXG4gICAgICBjYW52YXNDdHguY2xlYXJSZWN0KDAsIDAsIHdpZHRoLCBoZWlnaHQpO1xuXG4gICAgICB2YXIgZHJhd0FsdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBkcmF3VmlzdWFsID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGRyYXdBbHQpO1xuXG4gICAgICAgIGFuYWx5c2VyLmdldEJ5dGVGcmVxdWVuY3lEYXRhKGRhdGFBcnJheUFsdCk7XG5cbiAgICAgICAgY2FudmFzQ3R4LmZpbGxTdHlsZSA9ICdoc2woMCwgMCwgMCknO1xuICAgICAgICBjYW52YXNDdHguZmlsbFJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodCk7XG5cbiAgICAgICAgdmFyIGJhcldpZHRoID0gKHdpZHRoIC8gYnVmZmVyTGVuZ3RoQWx0KSAqIDIuNTtcbiAgICAgICAgdmFyIGJhckhlaWdodDtcbiAgICAgICAgdmFyIHggPSAwO1xuXG4gICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBidWZmZXJMZW5ndGhBbHQ7IGkrKykge1xuICAgICAgICAgIGJhckhlaWdodCA9IGRhdGFBcnJheUFsdFtpXTtcblxuICAgICAgICAgIGNhbnZhc0N0eC5maWxsU3R5bGUgPSAnaHNsKDAsIDAlLCcgKyBiYXJIZWlnaHQgKyAnJSknO1xuICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdiYXJIZWlnaHQnLCBiYXJIZWlnaHQpO1xuICAgICAgICAgIGNhbnZhc0N0eC5maWxsUmVjdCh4LGhlaWdodC1iYXJIZWlnaHQvMixiYXJXaWR0aCxiYXJIZWlnaHQvMik7XG5cbiAgICAgICAgICB4ICs9IGJhcldpZHRoICsgMTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgZHJhd0FsdCgpO1xuICAgIH1cbiAgfVxuXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgZnVuY3Rpb24gYWRkRGF0YSh2aWRlbykge1xuICAgIGNvbnN0IGNoYW5rc0NvdW50ID0gNDtcbiAgICBjb25zdCBjaGFua0xlbmd0aCA9IDQ1O1xuICAgIGNvbnN0IG1pbiA9IDEyMDtcbiAgICBjb25zdCBtYXggPSBtaW4gKyBjaGFua0xlbmd0aCAqIGNoYW5rc0NvdW50O1xuICAgIGxldCBjaGFua0l0ZW1zQ291bnRlciA9IG1pbjtcblxuICAgIGNvbnN0IGRhdGFFbGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRhdGEnKTtcbiAgICBjb25zdCBkYXRhTGlzdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3VsJyk7XG4gICAgZGF0YUxpc3QuY2xhc3NMaXN0LmFkZCgnZGF0YV9fbGlzdCcpO1xuXG4gICAgdmlkZW8uYWRkRXZlbnRMaXN0ZW5lcigncGxheScsIGZ1bmN0aW9uKCkge1xuICAgICAgZGF0YUVsZW0uY2xhc3NMaXN0LnJlbW92ZSgnZGF0YS0taGlkZGVuJyk7XG4gICAgfSwgMCk7XG5cbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgY2hhbmtzQ291bnQ7IGkrKyApIHtcbiAgICAgIGNvbnN0IGRhdGFJdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcbiAgICAgIGRhdGFJdGVtLmNsYXNzTGlzdC5hZGQoJ2RhdGFfX2l0ZW0nKTtcbiAgICAgIGRhdGFJdGVtLmlubmVySFRNTCA9ICcnO1xuICAgICAgZGF0YUxpc3QuYXBwZW5kQ2hpbGQoZGF0YUl0ZW0pO1xuICAgICAgbGV0IHNlY3Rpb25MZW5ndGggPSAwO1xuICAgICAgY29uc3Qgc3BhY2VTaXplID0gMztcbiAgICAgIGNvbnN0IHJhbmRDaGFua3NTZWN0aW9ucyA9IFtcbiAgICAgICAgTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogOCkgKyA1LFxuICAgICAgICBNYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkgKiA0KSArIDZcbiAgICAgIF07XG4gICAgICBsZXQgY3VycmVudFNlY3Rpb24gPSAwO1xuICAgICAgbGV0IGN1cnJlbnRTZWN0aW9uTGVuZ3RoID0gcmFuZENoYW5rc1NlY3Rpb25zW2N1cnJlbnRTZWN0aW9uXTtcbiAgICAgIGxldCBjdXJyZW50Q2hhbmtMZW5ndGggPSBNYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkgKiBjaGFua0xlbmd0aCAvIDIpICsgY2hhbmtMZW5ndGggLyAyO1xuICAgICAgY29uc3QgY2hhbmtzU3VtID0gcmFuZENoYW5rc1NlY3Rpb25zWzBdICsgcmFuZENoYW5rc1NlY3Rpb25zWzFdICsgc3BhY2VTaXplICogMjtcblxuICAgICAgLy8gQ3V0IGVtcHR5IHRhaWxzXG4gICAgICBpZiAoY3VycmVudENoYW5rTGVuZ3RoIC0gc3BhY2VTaXplIDw9IGNoYW5rc1N1bSkge1xuICAgICAgICBjdXJyZW50Q2hhbmtMZW5ndGggPSBjaGFua3NTdW0gLSBzcGFjZVNpemU7XG4gICAgICB9XG5cbiAgICAgIGZvcih2YXIgayA9IDA7IGsgPCBjdXJyZW50Q2hhbmtMZW5ndGg7IGsrKyApIHtcbiAgICAgICAgaWYgKHNlY3Rpb25MZW5ndGggPiBjdXJyZW50U2VjdGlvbkxlbmd0aCAmJiBzZWN0aW9uTGVuZ3RoIDw9IGN1cnJlbnRTZWN0aW9uTGVuZ3RoICsgc3BhY2VTaXplKSB7XG4gICAgICAgICAgICBkYXRhSXRlbS5pbm5lckhUTUwgKz0gayArICc8YnIvPic7XG5cbiAgICAgICAgICBpZiAoc2VjdGlvbkxlbmd0aCA9PT0gY3VycmVudFNlY3Rpb25MZW5ndGggKyBzcGFjZVNpemUpIHtcbiAgICAgICAgICAgIGN1cnJlbnRTZWN0aW9uKys7XG4gICAgICAgICAgICBjdXJyZW50U2VjdGlvbkxlbmd0aCA9IHJhbmRDaGFua3NTZWN0aW9uc1tjdXJyZW50U2VjdGlvbl07XG4gICAgICAgICAgICBzZWN0aW9uTGVuZ3RoID0gMDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG5cbiAgICAgICAgICBsZXQgY29udGVudExpc3QgPSBbXG4gICAgICAgICAgICBjaGFua0l0ZW1zQ291bnRlcixcbiAgICAgICAgICAgIChjaGFua0l0ZW1zQ291bnRlciAqIDUwKS50b1N0cmluZygxNilcbiAgICAgICAgICBdO1xuXG4gICAgICAgICAgLy8gQWRkIHJhbmRvbSBzaG9ydCB0YWlsc1xuICAgICAgICAgIGNvbnN0IHJhbmRTZXRMZW5ndGggPSBNYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkgKiAyKSArIDE7XG5cbiAgICAgICAgICBmb3IgKHZhciBtID0gMDsgbSA8IHJhbmRTZXRMZW5ndGg7IG0rKykge1xuICAgICAgICAgICAgY29udGVudExpc3QucHVzaCgoY2hhbmtJdGVtc0NvdW50ZXIgLSA0MCArIG0pLnRvU3RyaW5nKDE2KSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZGF0YUl0ZW0uaW5uZXJIVE1MICs9IGNvbnRlbnQgPSBjb250ZW50TGlzdC5qb2luKCdcXHQnKSArICc8YnIvPic7XG4gICAgICAgIH1cbiAgICAgICAgc2VjdGlvbkxlbmd0aCsrO1xuICAgICAgICBjaGFua0l0ZW1zQ291bnRlcisrO1xuICAgICAgfVxuICAgIH1cblxuICAgIGRhdGFFbGVtLmFwcGVuZENoaWxkKGRhdGFMaXN0KTtcbiAgfVxuXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgZnVuY3Rpb24gYW5pbWF0ZUZpbHRlcigpIHtcbiAgICBjb25zdCBmZU1hcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmZU1hcCcpO1xuICAgIGNvbnN0IGZlT2Zmc2V0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZlT2Zmc2V0Jyk7XG4gICAgY29uc3QgY29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250ZW50Jyk7XG4gICAgY29uc3QgY29udGVudEhhc0ZpbHRlckNsYXNzID0gJ2NvbnRlbnQtLWhhcy1maWx0ZXInO1xuICAgIGxldCBjbGFzc1dhc0FkZGVkID0gZmFsc2U7XG4gICAgbGV0IGN1cnJlbnRWYWwgPSAwO1xuICAgIGNvbnN0IG1heFZhbCA9IDEwMDtcbiAgICBsZXQgY3VycmVudE9mZnNldCA9IDA7XG4gICAgY29uc3Qgc3RlcCA9IDU7XG4gICAgbGV0IGRpcmVjdGlvbiA9ICd1cCc7XG5cbiAgICBhbmltYXRlKCk7XG5cbiAgICBmdW5jdGlvbiBhbmltYXRlKCkge1xuICAgICAgaWYgKGRpcmVjdGlvbiA9PT0gJ3VwJykge1xuICAgICAgICBpZiAoY3VycmVudFZhbCA8IG1heFZhbCkge1xuICAgICAgICAgIGN1cnJlbnRWYWwgKz0gc3RlcDtcbiAgICAgICAgICBzZXRWYWwoKTtcblxuICAgICAgICAgIGlmICghY2xhc3NXYXNBZGRlZCkge1xuICAgICAgICAgICAgY29udGVudC5jbGFzc0xpc3QuYWRkKGNvbnRlbnRIYXNGaWx0ZXJDbGFzcyk7XG4gICAgICAgICAgICBjbGFzc1dhc0FkZGVkID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgZGlyZWN0aW9uID0gJ2Rvd24nO1xuICAgICAgICAgIHNldFZhbCgpO1xuXG4gICAgICAgICAgaWYgKGNsYXNzV2FzQWRkZWQpIHtcbiAgICAgICAgICAgIGNvbnRlbnQuY2xhc3NMaXN0LnJlbW92ZShjb250ZW50SGFzRmlsdGVyQ2xhc3MpO1xuICAgICAgICAgICAgY2xhc3NXYXNBZGRlZCA9IGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIGlmIChjdXJyZW50VmFsID4gMCkge1xuICAgICAgICAgIGN1cnJlbnRWYWwgLT0gc3RlcDtcbiAgICAgICAgICBzZXRWYWwoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICBjb25zdCByYW5kRGVsYXkgPSBNYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkgKiAzKSArIDU7XG4gICAgICAgICAgZmVNYXAuc2V0QXR0cmlidXRlKCdzY2FsZScsIDApO1xuXG4gICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGFuaW1hdGUoKTtcbiAgICAgICAgICAgIGRpcmVjdGlvbiA9ICd1cCc7XG4gICAgICAgICAgfSwgcmFuZERlbGF5ICogMTAwMClcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldFZhbCgpIHtcbiAgICAgIGxldCBuZXdWYWwgPSBjdXJyZW50VmFsO1xuICAgICAgY3VycmVudE9mZnNldCA9IGN1cnJlbnRWYWwgLyAyLjU7XG5cbiAgICAgIGlmIChjdXJyZW50VmFsICUgMikge1xuICAgICAgICBuZXdWYWwgPSAtbmV3VmFsO1xuICAgICAgfVxuXG4gICAgICBmZU1hcC5zZXRBdHRyaWJ1dGUoJ3NjYWxlJywgbmV3VmFsKTtcbiAgICAgIGZlT2Zmc2V0LnNldEF0dHJpYnV0ZSgneCcsIC1jdXJyZW50T2Zmc2V0KTtcbiAgICAgIGZlT2Zmc2V0LnNldEF0dHJpYnV0ZSgneScsIC1jdXJyZW50T2Zmc2V0KTtcblxuICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGFuaW1hdGUpO1xuICAgIH1cbiAgfVxuXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgZ2V0U3RyZWFtKCk7XG5cbn0pKCk7XG4iXX0=
